print("Start-testscript");

path = "ownscripts/data/tiny.csv"

Z = read(path, schema="int,string", data_type = "frame", format = "csv", header = TRUE)
print("FRAME IS NOW")
print(toString(Z))

# here iterate over all double columns and do the outlier detection
Q = as.scalar(Z[1,1])
N = Q %% 1

if ( N > 0) {
    print("we are double")
} else {
    print("we are integer")
}

B = Z[, 1]
M = as.matrix(B)
Y = outlierBySd(M, 1, 2, 0, FALSE);
T = as.frame(Y)

for (i in 1:nrow(T)) {
    intvalue = as.integer(as.scalar(Y[i, 1]))
    if(intvalue > 0) {
      Z[i, 1] = intvalue
    } else {
      Z[i, 1] = T[i]
    }
}

#Z[, 1] = T
print(toString(Z))